<div class="cart-main-section">
  <div class="container">
    <div class="row">
      <div class="col">
        <div class="cart-page-section-title-wrapper">
          <div class="cart-page-title">Cart</div>
        </div>
      </div>
      <div class="col">
        <div class="cart-main-wrapper">
          {% if cart.item_count == 0 %}
            <div class="cart-empty-wrapper">
              <div class="cart-empty-icon">
                <svg width="64" height="64" viewBox="0 0 32 32" fill="none" stroke="#d32f2f" stroke-width="2">
                  <rect x="6" y="12" width="20" height="14" rx="3" />
                  <path d="M10 12V9a6 6 0 1 1 12 0v3" />
                  <circle cx="16" cy="20" r="2" />
                  <path d="M16 22v2" />
                </svg>
              </div>
              <h2 class="cart-empty-title">YOUR CART IS EMPTY.</h2>
              <p class="cart-empty-desc">
                Before proceed to checkout you must add some products to your shopping cart.<br>
                You will find a lot of interesting products on our “Shop” page.
              </p>
              <a href="{{ routes.all_products_collection_url }}" class="cart-empty-btn">RETURN TO SHOP</a>
            </div>
          {% else %}
            <!-- Unified div-based list for desktop and mobile -->
            <div class="cart-items">
              {% for item in cart.items %}
                {% assign variant_image = item.image
                  | default: item.variant.image
                  | default: item.product.featured_image
                %}
                {% assign show_variants = false %}

                {% for option in item.options_with_values %}
                  {% unless option.value == 'Default Title' or option.value == 'Default' or option.name == 'Title' %}
                    {% assign show_variants = true %}
                  {% endunless %}
                {% endfor %}

                {% if item.selling_plan_allocation.selling_plan.name %}
                  {% assign show_variants = true %}
                {% endif %}
                <div class="cart-item cart-item-row" data-key="{{ item.key }}" role="row">
                  <div class="cart-product-info" role="cell">
                    <div class="item-loader hidden" id="item-loader-{{ item.key | replace: ':', '-' }}">
                      <div class="loader"></div>
                    </div>
                    <img
                      src="{{ variant_image | image_url }}"
                      alt="{{ item.title }}"
                      width="70"
                      height="70"
                      class="cart-page-item-image"
                    >
                    <div class="cart-page-title-wrapper">
                      <div class="cart-title-row">
                        <a href="{{ item.url }}" class="cart-item-title">{{ item.title }}</a>
                        {% if show_variants %}
                          <div class="cart-item-variation-list">
                            {% for option in item.options_with_values %}
                              {% if option.value != 'Default Title' %}
                                <span class="cart-item-variant">{{ option.value }}</span>
                              {% endif %}
                            {% endfor %}

                            <span class="cart-item-variant">
                              {{- item.selling_plan_allocation.selling_plan.name -}}
                            </span>
                          </div>
                        {% endif %}
                      </div>
                      <div class="cart-page-qty-wrapper">
                        {% render 'product-quantity', product: item, appliedQty: item.quantity, index: forloop.index %}
                      </div>
                    </div>
                  </div>
                  <div class="cart-item-meta">
                    <button type="button" class="cart-remove-btn" title="Remove">
                      <img src="{{ 'cancel.png' | asset_url }}" alt="Remove" width="14" height="14">
                    </button>
                    <div class="cart-item-line-total" role="cell">{{ item.line_price | money }}</div>
                  </div>
                </div>
              {% endfor %}
            </div>

            <div class="cart-summary-wrapper">
              <div class="cart-summary">
                <p class="cart-subtotal">
                  <strong>SUBTOTAL</strong> <span id="cart-subtotal">{{ cart.total_price | money }}</span>
                </p>
                <p class="cart-taxes">Taxes, shipping and discounts codes calculated at checkout</p>
              </div>

              <a href="/checkout" class="cart-checkout-btn" id="cart-checkout-btn">Proceed to checkout</a>
            </div>
            <script>
              window.Shopify = window.Shopify || {};
              Shopify.money_format = '{{ shop.money_format | escape }}';
            </script>
            <script src="{{ 'cart-page.js' | asset_url }}" defer></script>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
